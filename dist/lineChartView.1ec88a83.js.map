{"version":3,"sources":["scripts/lineChartView.js"],"names":["exportDate","Date","svg","xAxis","yAxis","blDomainStorage","margin","top","right","bottom","left","width","height","checkboxes","document","getElementsByClassName","checkbox","addEventListener","visualiseChosenBL","initializeSVG","found","forEach","arr","value","checked","fetchData","then","data","neededYValue","d3","scaleLinear","domain","max","item","Infos","AnzahlFall","sort","a","b","length","select","remove","addAxes","push","Bundesland","blClassN","visualiseCurve","updateExistingCurvesCircles","selectAll","i","splice","append","classed","attr","bundesland","fetch","method","response","json","casesData","feed","features","elem","attributes","groupDataByDate","groupedReport","reduce","dataEntries","currentValue","day","undefined","IdBundesland","reportArr","Object","entries","key","Meldedatum","scaleTime","extent","range","xA","axisBottom","tickSizeOuter","parseDate","timeFormat","tickFormat","d","call","style","labels","on","mouseEvent","target","date","appendVerticalLine","nice","axisLeft","formattedData","classN","color","datum","line","x","y","text","enter","storageArray"],"mappings":"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","file":"lineChartView.1ec88a83.js","sourceRoot":"..\\src","sourcesContent":["/** `exportDate` is set in the event handler added to the ticks of the xAxis. \r\n  It contains the selected date which should be used for the treemap.\r\n  To import the clicked date use `import date from './lineChartView.js' in the treemap file`.\r\n  Make sure that the type of the treemap file is set to `module` in the index.html file, e.g.:\r\n   <script type=\"module\" src=\"scripts/values.js\" ></script>\r\n  */\r\nlet exportDate = new Date();\r\nexport default exportDate;\r\n\r\nlet svg, xAxis, yAxis;\r\nconst blDomainStorage = [];\r\n\r\n\r\nconst margin = {top:10, right: 30, bottom: 60, left: 60},\r\n  width = 800 - margin.left - margin.right,\r\n  height = 400 - margin.top - margin.bottom;\r\n\r\n\r\n// This is the entry point for the Bundesländer select via the treemap later on\r\nconst checkboxes = document.getElementsByClassName('checkbox')\r\nfor (let checkbox of checkboxes){\r\n  checkbox.addEventListener('change', visualiseChosenBL) \r\n}\r\n\r\ninitializeSVG();\r\n\r\n\r\n/** Saves the checked checkboxes to the array `blDomainStorage` \r\n  and visualises the chosen Bundesland.\r\n*/\r\nfunction visualiseChosenBL(){\r\n\r\n  // Pushes the names of the chosen Bundesland into the array `blDomainStorage`\r\n  for (let checkbox of checkboxes){\r\n    \r\n    \r\n    let found = false;\r\n    blDomainStorage.forEach(arr => {\r\n      if(checkbox.value == arr[0]) found = true;\r\n    })\r\n\r\n    // Checks if Bundesland is newly checked or if it already exists in blDomainStorage\r\n    if(checkbox.checked && found == false){\r\n\r\n      // Fetching the data of the newly selected Bundesland\r\n      fetchData(checkbox.value).then((data) => {\r\n\r\n        // To figure out the max y-value which is necessary to correctly display the data\r\n        const neededYValue = d3.scaleLinear().domain([0, d3.max(data, item => item.Infos.AnzahlFall)])\r\n \r\n        /** Sorts the array in increasing order.\r\n          The Bundesland with the smallest needed y-value comes first and the one with the highest comes last.\r\n        */\r\n        blDomainStorage.sort((a,b) => {\r\n          return a[1] - b[1];\r\n        })\r\n\r\n        /** Checks whether the last Bundesland in `blDomainStorage` still obtains the highest needed\r\n          y-value compared to the newly selected Bundesland. If the newly checked Bundesland has\r\n          more Covid cases and therefore needs a higher y-value the current axes are removed \r\n          and the updated ones are added.\r\n        */\r\n        if(blDomainStorage.length == 0 || blDomainStorage[blDomainStorage.length-1][1] < neededYValue.domain()[1]){\r\n          svg.select(\".y-axis\").remove(); // instead of deleting they should be updated,\r\n          svg.select(\".x-axis\").remove(); // but that seems more complicated\r\n          svg.select(\".case-line\").remove(); //removes existing vertical line\r\n          addAxes(data);\r\n        }\r\n      \r\n        // Stores the Bundesland and the highest y-value needed for that Bundesland\r\n        blDomainStorage.push([data[0].Infos.Bundesland, neededYValue.domain()[1]]);   \r\n\r\n        /** The curve of the newly selected Bundesland is added.\r\n          `blClassN` is necessary to give each curve a distinguishable class name.\r\n          It will be used to select the d3 element and then to update and delete it.\r\n        */\r\n        const blClassN = data[0].Infos.Bundesland\r\n        visualiseCurve(svg, data, xAxis, yAxis, blClassN, \"turquoise\");\r\n          \r\n        // Circles of the already displayed Bundesländer are updated according to the new axis. \r\n        updateExistingCurvesCircles(blDomainStorage);\r\n      })\r\n      \r\n    } else if(!checkbox.checked && found == true) {\r\n\r\n        // Removes the curve and circles of the recently unselected Bundesland.\r\n        svg.select(\".curve.\"+checkbox.value).remove();\r\n        svg.selectAll(\".circles.\"+checkbox.value).remove();\r\n\r\n       /** Sorts the array in increasing order.\r\n          The Bundesland with the smallest needed y-value comes first and the one with the \r\n          highest comes last.\r\n        */\r\n        blDomainStorage.sort((a,b) => {\r\n          return a[1] - b[1];\r\n        })\r\n\r\n        // Removes the recently unselected Bundesland from `blDomainStorage`\r\n        blDomainStorage.forEach((arr, i) => {\r\n          if(arr[0] == checkbox.value) {\r\n           blDomainStorage.splice(i,1)\r\n          }\r\n        })\r\n\r\n        /** Updates the axes, the existing curves and circles if the highest needed y-value \r\n          has changed after unselecting a Bundesland\r\n        */\r\n        if(yAxis.domain()[1] > blDomainStorage[blDomainStorage.length-1][1]){\r\n          fetchData(blDomainStorage[blDomainStorage.length-1][0]).then((data) => {\r\n            svg.select(\".y-axis\").remove(); \r\n            svg.select(\".x-axis\").remove(); \r\n            svg.select(\".case-line\").remove(); //removes existing vertical line\r\n\r\n            addAxes(data)\r\n            updateExistingCurvesCircles(blDomainStorage);            \r\n          }) \r\n        } \r\n      }\r\n  }\r\n}\r\n\r\n\r\nfunction initializeSVG(){\r\n  svg = d3.select(\"#visualisationContainer\")\r\n          .append(\"div\")\r\n          .classed(\"svg-container\", true) \r\n          .append(\"svg\")\r\n          .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\r\n          .attr(\"viewBox\", \"0 0 600 400\")\r\n          .classed(\"svg-content-responsive\", true)\r\n          .append(\"g\")\r\n          .attr(\"transform\", `translate(${margin.left}, ${margin.top})`);             \r\n}\r\n\r\n\r\nfunction fetchData(bundesland){\r\n    return fetch(\r\n      `https://services7.arcgis.com/mOBPykOjAyBO2ZKk/arcgis/rest/services/RKI_COVID19/FeatureServer/0/query?where=Meldedatum%20%3E%3D%20TIMESTAMP%20%272020-11-01%2000%3A00%3A00%27%20AND%20Meldedatum%20%3C%3D%20TIMESTAMP%20%272020-12-15%2000%3A00%3A00%27%20AND%20Bundesland%20%3D%20%27${bundesland}%27&outFields=Bundesland,AnzahlFall,Meldedatum,IdBundesland&outSR=4326&f=json`,\r\n        {\r\n            method: 'GET'\r\n        })\r\n        .then(response => response.json())\r\n        .then(data => {\r\n            /** `casesData` is the array where the fetched data will be stored in.\r\n              `feed` is the array of objects returned by the request.\r\n              Each array entry has the following schema\r\n              [attributes: {Bundesland: \"\", AnzahlFall: \"\", IdBundesland: \"\", Meldedatum: \"\"}]\r\n              By iterating through `feed` and pushing the objects to `casesData` one depth is removed so\r\n              the data can be handled more easily.\r\n            */\r\n            let casesData = [];\r\n            const feed = data.features;\r\n            feed.forEach(elem => {\r\n              casesData.push(elem.attributes);\r\n            });\r\n            return groupDataByDate(casesData)\r\n        });\r\n};\r\n\r\n  \r\n/** Groups the received data by date. After the grouping the data is sorted\r\n  datewise and returned as an array\r\n*/\r\nfunction groupDataByDate(casesData){\r\n  /** `dataEntries` is a new object and `currentValue` is the item of the array \r\n    currently looked at\r\n  */\r\n  const groupedReport = casesData.reduce((dataEntries, currentValue) => {\r\n    let day = new Date(currentValue['Meldedatum']);\r\n    \r\n    /** Within the first iteration of `reduce` `dataEntries` is undefined. \r\n      Consequently a new object entry with the `Meldedatum` as the key is being added to\r\n      `dataEntries`. Further information (Bundesland, IdBundesland, AnzahlFall) \r\n      are added as a value.       \r\n    */\r\n    if(dataEntries[day] !== undefined){\r\n      /** If a key with the `Meldedatum` already exists the number of cases are\r\n        summed up.\r\n      */\r\n      dataEntries[day].AnzahlFall = dataEntries[day].AnzahlFall + currentValue.AnzahlFall;  \r\n    } else {\r\n      dataEntries[day] = {\r\n        Bundesland: currentValue.Bundesland,\r\n        IdBundesland: currentValue.IdBundesland,\r\n        AnzahlFall: currentValue.AnzahlFall\r\n      };  \r\n    }        \r\n    return dataEntries\r\n  },{})\r\n\r\n  // `dataEntries` gets transformed into an array so it can be easily sorted by date  \r\n  let reportArr = [];\r\n  Object.entries(groupedReport).forEach(([key, value]) => {\r\n    reportArr.push({Meldedatum: key, Infos: value})\r\n  })\r\n  // Sorts the array containing the summed up cases by `Meldedatum`\r\n  reportArr.sort((a, b) => b.Meldedatum - a.Meldedatum)\r\n  return reportArr;\r\n}\r\n\r\n\r\nfunction addAxes(data){\r\n  /** The next 7 lines initialize and format the labels of the xAxis nicely.    \r\n    If there are too less dates will be repeated on the x-axis. To avoid that we have to create a function \r\n    for that edge case and work with xa.tickValues to set the labels manually.\r\n    xA.tickValues([new Date(data[0].Meldedatum), new Date(data[1].Meldedatum), new Date(data[2].Meldedatum)])\r\n  */\r\n  xAxis = d3.scaleTime()\r\n              .domain(d3.extent(data, item => new Date(item.Meldedatum)))\r\n              .range([0, width]);\r\n  const xA = d3.axisBottom(xAxis);\r\n  xA.tickSizeOuter(0); // removes the last tick on the xAxis\r\n  const parseDate = d3.timeFormat(\"%B %d, %Y\") //https://d3-wiki.readthedocs.io/zh_CN/master/Time-Scales/\r\n  xA.tickFormat(d => parseDate(d));\r\n \r\n  // Appends the xAxis\r\n  svg.append(\"g\")\r\n      .attr(\"transform\", `translate(0, ${height})`)\r\n      .attr(\"class\", \"x-axis\")\r\n      .call(xA)\r\n      .selectAll(\"text\")\r\n      .attr(\"transform\", \"rotate(330)\") //rotates the labels of the x axis by \r\n      .style(\"text-anchor\", \"end\"); //makes sure that the end of the text string is anchored to the ticks\r\n\r\n   /** Selects all the labels on the xAxis. \r\n    The cursor becomes a pointer when moving the mouse over the xAxis labels.\r\n    When clicking on one label the function `appendVerticalLine` is being called \r\n    and the selected `date` set so it can be exported. (See top of this file)\r\n  */\r\n  const labels = d3.selectAll('g.tick') \r\n  \r\n  labels.on(\"mouseover\", (mouseEvent) => {\r\n    d3.select(mouseEvent.target).style(\"cursor\", \"pointer\"); // the pointer isn't visible anymore for some reason\r\n  });\r\n  labels.on(\"click\", (mouseEvent, date) => {\r\n    appendVerticalLine(svg, xAxis, date, height)\r\n    exportDate = date;\r\n  })  \r\n\r\n  // Initializes and formats the yAxis\r\n  yAxis = d3.scaleLinear()\r\n      .domain([0, d3.max(data, item => item.Infos.AnzahlFall)])\r\n      .range([height, 0])\r\n      .nice(); //without that the highest tick of the y axis wouldn't be labelled\r\n  \r\n  // Appends the yAxis\r\n  svg.append(\"g\")\r\n      .call(d3.axisLeft(yAxis))\r\n      .attr(\"class\", \"y-axis\"); // Class added to be able to remove the axis;\r\n}\r\n\r\n\r\nfunction visualiseCurve(svg, formattedData, xAxis, yAxis, classN, color){\r\n  svg.append(\"path\")\r\n    .datum(formattedData)\r\n    .attr(\"fill\", \"none\")\r\n    .attr(\"id\", classN)\r\n    .attr(\"stroke\", color)\r\n    .attr(\"stroke-width\", 1)\r\n    .attr(\"class\", \"curve\" + \" \" + classN) //necessary to add a specific class for every Bundesland shown\r\n    .attr(\"d\", d3.line()\r\n        .x(item => xAxis(new Date(item.Meldedatum)))\r\n        .y(item => yAxis(new Date(item.Infos.AnzahlFall)))\r\n    );\r\n\r\n  // Appends name of the Bundesland to the corresponding path\r\n  svg.append(\"text\")\r\n    .attr(\"x\", 5) // move the text from the start of the path\r\n    .attr(\"dy\", 15) // move the text down\r\n    .append(\"textPath\")\r\n      .attr(\"xlink:href\",\"#\"+classN)\r\n      .text(formattedData[0].Infos.Bundesland);\r\n\r\n  // Appends circles to the path at the dates where data is returned\r\n  svg.selectAll(\"circles\")\r\n      .data(formattedData)\r\n      .enter()\r\n      .append(\"circle\")\r\n        .attr(\"class\", \"circles\" + \" \" + classN)\r\n        .attr(\"fill\", \"darkblue\")\r\n        .attr(\"stroke\", \"none\")\r\n        .attr(\"cx\", item => xAxis(new Date(item.Meldedatum)))\r\n        .attr(\"cy\", item => yAxis(new Date(item.Infos.AnzahlFall)))\r\n        .attr(\"r\", 2)\r\n}\r\n\r\n// Appends a vertical line at the selected date\r\nfunction appendVerticalLine(svg, xAxis, date, height){\r\n  d3.select(\".case-line\").remove(); //removes existing vertical line\r\n\r\n  svg.append(\"line\")\r\n    .attr(\"class\", \"case-line\")\r\n    .attr(\"x1\", xAxis(date))  \r\n    .attr(\"y1\", 0)\r\n    .attr(\"x2\", xAxis(date))  \r\n    .attr(\"y2\", height)\r\n    .style(\"stroke-width\", 1)\r\n    .style(\"stroke\", \"darkblue\")\r\n    .style(\"fill\", \"none\");\r\n}\r\n\r\n\r\nfunction updateExistingCurvesCircles(storageArray){\r\n  storageArray.forEach((arr) => {\r\n    svg.select(\".curve.\"+ arr[0])\r\n      .attr(\"d\", d3.line()\r\n      .x(item => xAxis(new Date(item.Meldedatum)))\r\n      .y(item => yAxis(new Date(item.Infos.AnzahlFall)))\r\n    );\r\n\r\n    svg.selectAll(\".circles.\"+ arr[0])\r\n      .attr(\"cx\", item => xAxis(new Date(item.Meldedatum)))\r\n      .attr(\"cy\", item => yAxis(new Date(item.Infos.AnzahlFall))\r\n    );\r\n  })\r\n}"]}